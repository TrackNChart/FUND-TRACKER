<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense & Budget Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      min-height: 100vh;
      font-family: Inter, sans-serif;
      background: url('https://images.unsplash.com/photo-1581092334603-172a9bfa54e3?auto=format&fit=crop&w=1600&q=80') center/cover fixed no-repeat;
    }
    .overlay {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(6px);
      border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    #logout-btn {
      position: absolute;
      right: 1rem;
      top: 1rem;
    }
  </style>
</head>
<body class="p-6">

  <!-- Header -->
  <header class="overlay p-6 mb-6 relative">
    <h1 class="text-2xl font-bold">ðŸ’° Expense & Budget Tracker</h1>
    <button id="logout-btn" class="hidden bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600">Logout</button>
  </header>

  <!-- Auth -->
  <section id="auth-section" class="max-w-md mx-auto overlay p-6 mb-6">
    <h2 id="auth-title" class="text-xl font-semibold mb-4">Log In</h2>

    <!-- Login -->
    <form id="login-form" class="space-y-3">
      <input id="login-username" type="text" placeholder="Username" class="w-full p-2 border rounded" required>
      <input id="login-password" type="password" placeholder="Password" class="w-full p-2 border rounded" required>
      <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Log In</button>
      <p class="text-sm text-center">Donâ€™t have an account? 
        <a href="#" id="show-signup" class="text-blue-600 underline">Sign Up</a>
      </p>
    </form>

    <!-- Sign Up -->
    <form id="signup-form" class="space-y-3 hidden">
      <input id="signup-username" type="text" placeholder="Choose username" class="w-full p-2 border rounded" required>
      <input id="signup-password" type="password" placeholder="Choose password" class="w-full p-2 border rounded" required>
      <button type="submit" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Sign Up</button>
      <p class="text-sm text-center">Already have an account? 
        <a href="#" id="show-login" class="text-blue-600 underline">Log In</a>
      </p>
    </form>

    <p id="auth-msg" class="mt-3 text-sm text-red-600"></p>
  </section>

  <!-- Dashboard -->
  <main id="dashboard" class="hidden max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">

    <!-- Budget -->
    <div class="overlay p-6 space-y-4">
      <h3 class="text-lg font-semibold">Set Budget</h3>
      <input id="budget-input" type="number" class="w-full p-2 border rounded" placeholder="Enter budget (â‚±)">
      <button id="set-budget" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Set Budget</button>
      <p id="budget-display" class="mt-3 font-medium">Budget: â‚±0.00</p>
    </div>

    <!-- Add Expense -->
    <div class="overlay p-6 space-y-4">
      <h3 class="text-lg font-semibold">Add Expense</h3>
      <input id="expense-name" type="text" placeholder="Expense name" class="w-full p-2 border rounded">
      <input id="expense-amount" type="number" placeholder="Amount" class="w-full p-2 border rounded">
      <input id="expense-date" type="date" class="w-full p-2 border rounded">
      <select id="expense-category" class="w-full p-2 border rounded">
        <option value="Food">Food</option>
        <option value="Transport">Transport</option>
        <option value="Bills">Bills</option>
        <option value="Shopping">Shopping</option>
        <option value="Other">Other</option>
      </select>
      <button id="add-expense" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Add Expense</button>
    </div>

    <!-- Summary -->
    <div class="overlay p-6 space-y-2">
      <h3 class="text-lg font-semibold">Summary</h3>
      <p id="total-expenses">Total Expenses: â‚±0.00</p>
      <p id="remaining-budget">Remaining Budget: â‚±0.00</p>
      <hr>
      <p id="monthly-total">Monthly Expenses: â‚±0.00</p>
      <p id="annual-total">Annual Expenses: â‚±0.00</p>
      <button id="reset-btn" class="mt-4 w-full bg-red-500 text-white py-2 rounded hover:bg-red-600">Reset Tracker</button>
    </div>

    <!-- Expense List -->
    <div class="overlay p-6 col-span-2 max-h-72 overflow-y-auto">
      <h3 class="text-lg font-semibold mb-3">Expenses</h3>
      <ul id="expense-list" class="text-sm space-y-2"></ul>
    </div>

    <!-- Charts -->
    <div class="overlay p-6">
      <h3 class="text-lg font-semibold mb-3">Category Breakdown</h3>
      <canvas id="expensePie" height="160"></canvas>
    </div>
    <div class="overlay p-6 col-span-2">
      <h3 class="text-lg font-semibold mb-3">Monthly Expenses (This Year)</h3>
      <canvas id="monthlyBar" height="160"></canvas>
    </div>
  </main>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Storage
  let users = JSON.parse(localStorage.getItem('users') || '{}');
  let currentUser = null;
  let budget = 0;
  let expenses = [];
  const categories = ['Food','Transport','Bills','Shopping','Other'];

  // DOM refs
  const loginForm = document.getElementById('login-form');
  const signupForm = document.getElementById('signup-form');
  const showSignup = document.getElementById('show-signup');
  const showLogin = document.getElementById('show-login');
  const authMsg = document.getElementById('auth-msg');
  const authSection = document.getElementById('auth-section');
  const dashboard = document.getElementById('dashboard');
  const logoutBtn = document.getElementById('logout-btn');

  const budgetInput = document.getElementById('budget-input');
  const budgetDisplay = document.getElementById('budget-display');
  const totalExpensesEl = document.getElementById('total-expenses');
  const remainingBudgetEl = document.getElementById('remaining-budget');
  const monthlyTotalEl = document.getElementById('monthly-total');
  const annualTotalEl = document.getElementById('annual-total');
  const expenseListEl = document.getElementById('expense-list');

  // Charts
  const pieChart = new Chart(document.getElementById('expensePie').getContext('2d'), {
    type: 'pie',
    data: { labels: categories, datasets: [{ data: categories.map(()=>0), backgroundColor: ['#f87171','#60a5fa','#facc15','#34d399','#a78bfa'] }] }
  });
  const barChart = new Chart(document.getElementById('monthlyBar').getContext('2d'), {
    type: 'bar',
    data: { labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'], datasets:[{ label:'Monthly (â‚±)', data:Array(12).fill(0), backgroundColor:'#60a5fa'}] },
    options: { scales: { y: { beginAtZero:true } } }
  });

  // Helpers
  function saveUsers() { localStorage.setItem('users', JSON.stringify(users)); }
  function showDashboard() { authSection.classList.add('hidden'); dashboard.classList.remove('hidden'); logoutBtn.classList.remove('hidden'); }
  function showAuth(msg='') { authSection.classList.remove('hidden'); dashboard.classList.add('hidden'); logoutBtn.classList.add('hidden'); authMsg.textContent = msg; }

  function updateUI() {
    budgetDisplay.textContent = `Budget: â‚±${budget.toFixed(2)}`;
    const total = expenses.reduce((s,e)=>s+e.amount,0);
    totalExpensesEl.textContent = `Total Expenses: â‚±${total.toFixed(2)}`;
    const remaining = budget-total;
    remainingBudgetEl.textContent = `Remaining Budget: â‚±${remaining.toFixed(2)}`;
    const now=new Date();
    const monthTotal = expenses.filter(e=>new Date(e.date).getMonth()===now.getMonth()&&new Date(e.date).getFullYear()===now.getFullYear()).reduce((s,e)=>s+e.amount,0);
    const yearTotal = expenses.filter(e=>new Date(e.date).getFullYear()===now.getFullYear()).reduce((s,e)=>s+e.amount,0);
    monthlyTotalEl.textContent = `Monthly Expenses: â‚±${monthTotal.toFixed(2)}`;
    annualTotalEl.textContent = `Annual Expenses: â‚±${yearTotal.toFixed(2)}`;
    renderExpenses();
    updateCharts();
  }

  function renderExpenses() {
    expenseListEl.innerHTML='';
    expenses.forEach((e,i)=>{
      const li=document.createElement('li');
      li.textContent=`${e.date} â€” ${e.name} (â‚±${e.amount.toFixed(2)}) [${e.category}]`;
      expenseListEl.appendChild(li);
    });
  }

  function updateCharts() {
    const catTotals = categories.map(c=>0);
    expenses.forEach(e=>{catTotals[categories.indexOf(e.category)] += e.amount;});
    pieChart.data.datasets[0].data=catTotals; pieChart.update();
    const monthly=Array(12).fill(0); const year=new Date().getFullYear();
    expenses.forEach(e=>{const d=new Date(e.date); if(d.getFullYear()===year) monthly[d.getMonth()]+=e.amount;});
    barChart.data.datasets[0].data=monthly; barChart.update();
  }

  function saveUserData() {
    if(!currentUser) return;
    users[currentUser].budget=budget;
    users[currentUser].expenses=expenses;
    saveUsers();
  }

  // Auth
  showSignup.addEventListener('click', e=>{e.preventDefault(); loginForm.classList.add('hidden'); signupForm.classList.remove('hidden'); authMsg.textContent='';});
  showLogin.addEventListener('click', e=>{e.preventDefault(); signupForm.classList.add('hidden'); loginForm.classList.remove('hidden'); authMsg.textContent='';});

  signupForm.addEventListener('submit', e=>{
    e.preventDefault();
    const u=document.getElementById('signup-username').value.trim();
    const p=document.getElementById('signup-password').value;
    if(users[u]) return authMsg.textContent='Username already exists';
    users[u]={password:p,budget:0,expenses:[]};
    saveUsers();
    authMsg.textContent='Account created, please log in.';
    signupForm.reset(); signupForm.classList.add('hidden'); loginForm.classList.remove('hidden');
  });

  loginForm.addEventListener('submit', e=>{
    e.preventDefault();
    const u=document.getElementById('login-username').value.trim();
    const p=document.getElementById('login-password').value;
    if(!users[u]||users[u].password!==p) return authMsg.textContent='Invalid credentials';
    currentUser=u; budget=users[u].budget||0; expenses=users[u].expenses||[];
    showDashboard(); updateUI();
  });

  logoutBtn.addEventListener('click', ()=>{currentUser=null; showAuth('Logged out');});

  // Tracker
  document.getElementById('set-budget').addEventListener('click',()=>{budget=Number(budgetInput.value)||0; saveUserData(); updateUI();});
  document.getElementById('add-expense').addEventListener('click',()=>{
    const nm=document.getElementById('expense-name').value.trim();
    const am=Number(document.getElementById('expense-amount').value);
    const dt=document.getElementById('expense-date').value;
    const cat=document.getElementById('expense-category').value;
    if(!nm||!am||!dt) return alert('Fill all fields');
    expenses.push({name:nm,amount:am,date:dt,category:cat});
    saveUserData(); updateUI();
    document.getElementById('expense-name').value='';
    document.getElementById('expense-amount').value='';
    document.getElementById('expense-date').value='';
  });
  document.getElementById('reset-btn').addEventListener('click',()=>{
    if(confirm('Reset tracker?')){budget=0; expenses=[]; saveUserData(); updateUI();}
  });

  // Init
  showAuth();
});
</script>
</body>
</html>
